# B2B Portal MVP (PHP + MySQL)

Портал реализован как серверный интерфейс для ежедневной работы с проектами,
расчётами DDP, ТН ВЭД, историей операций, закладками и минимальной админкой.

## Структура

- `index.php` — Пульт (главная)
- `projects.php` — Проекты (список)
- `project.php` — Обзор проекта
- `ddp_new.php` — Новый расчёт DDP
- `tnved.php` — Реестр ТН ВЭД
- `tnved_card.php` — Карточка ТН ВЭД
- `history.php` — История операций
- `bookmarks.php` — Закладки
- `admin.php` — Админка (пользователи, роли, справочники)
- `login.php` / `logout.php` — доступ
- `assets/styles.css` — единый корпоративный стиль
- `sql/schema.sql` — схема базы данных

## Установка (ByetHost)

1. Создайте базу данных MySQL и импортируйте `sql/schema.sql`.
2. Настройте соединение с БД:
   - Если на хостинге доступны переменные окружения, укажите:
     - `DB_HOST`, `DB_NAME`, `DB_USER`, `DB_PASS`
     - `SETUP_KEY` — секрет для первичной настройки
   - Если переменные окружения недоступны, скопируйте `includes/config.local.php.example`
     в `includes/config.local.php` и заполните значения там.
   - В `config.local.php` указывайте значения напрямую, а не через `getenv()`:
     ```php
     define('DB_HOST', 'sql107.byethost7.com');
     define('DB_NAME', 'b7_36760225_combain');
     define('DB_USER', 'b7_36760225');
     define('DB_PASS', 'ваш_пароль');
     define('SETUP_KEY', 'ваш_секретный_ключ');
     ```
3. Загрузите файлы портала на сервер.
4. Откройте `login.php`. Если пользователей нет, появится форма первичного администратора.

## Безопасность

- Все формы защищены CSRF.
- Все SQL-запросы выполняются через подготовленные выражения.
- Вывод пользовательских данных экранируется.

## Примечания

- Все операции выполняются только в контексте проекта.
- Формулы DDP фиксированы, расчёты сохраняются и воспроизводимы.
